<Page x:Class="XmlEditorTool.XMLEditorView"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
      xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
      xmlns:local="clr-namespace:XmlEditorTool"
      xmlns:utility="clr-namespace:XmlEditorTool.Utility"
      mc:Ignorable="d" 
      d:DesignHeight="350" d:DesignWidth="720"
      Title="Xml Editor Tool - Editor">

    <Grid>
        <Grid.Resources>
            <Image x:Key="UploadImage" Height="64"
                   Source="Resources/File-Adobe-Dreamweaver-XML-01-icon.png"/>
        </Grid.Resources>
        <Grid.ColumnDefinitions>
            <ColumnDefinition ></ColumnDefinition>
            <ColumnDefinition />
        </Grid.ColumnDefinitions>

        <Grid.RowDefinitions>
            <RowDefinition Height="35"></RowDefinition>
            <RowDefinition Height="35"></RowDefinition>
            <RowDefinition />
        </Grid.RowDefinitions>

        <!-- Menu -->
        <Border Grid.Row="0" Background="LightGray" BorderThickness="2,2,0,2"/>
        <Border Grid.Row="0" Grid.Column="1" Background="LightGray" BorderThickness="0,2,2,2"/>

        <Menu Name="MenuBar" Width="Auto" Background="Transparent" HorizontalAlignment="Left" 
              VerticalAlignment="Center" IsMainMenu="True" Grid.Row="0">
            <Menu.BitmapEffect>
                <DropShadowBitmapEffect/>
            </Menu.BitmapEffect>
            <MenuItem Header="Application" Name="AppMenu">
                <MenuItem Header="Settings" Name="Settings" Click="OpenSettings"></MenuItem>
                <MenuItem Header="Export to XML..." Name="ExportXML" Click="ExportXml"/>
                <MenuItem Header="Close" Name="Exit" Click="CloseApp"></MenuItem>
            </MenuItem>
        </Menu>
        
        <!-- Header -->
        <Label Grid.Column="0" Grid.Row="1" VerticalContentAlignment="Center"
               HorizontalContentAlignment="Center" Background="Navy" 
               Foreground="White">XML File View</Label>

        
        <!-- File Upload Panel -->
        <Grid Name="FileUploadGrid" Grid.Column="0" Grid.Row="2" Background="LightGray">
            <Grid.ColumnDefinitions>
                <ColumnDefinition/>
            </Grid.ColumnDefinitions>
            <Grid.RowDefinitions>
                <RowDefinition/>
                <RowDefinition/>
                <RowDefinition/>
            </Grid.RowDefinitions>

            <StackPanel Grid.Row="1" Name="UploadPanel" Drop="UploadDrop" 
                        AllowDrop="True" Background="Transparent">

                <Button HorizontalAlignment="Center" 
                VerticalAlignment="Center" Click="UploadFileClick"
                Content="{StaticResource UploadImage}">
                </Button>
            </StackPanel>
            <Label Grid.Column="0" Grid.Row="2" HorizontalContentAlignment="Center"
               VerticalContentAlignment="Top">Drop .xml file or click button</Label>
        </Grid>
        
        <!-- Treeview Panel -->
        <TreeView Name="XmlTreeView" Grid.Column="0" Grid.Row="2" 
                  Visibility="Hidden" SelectedItemChanged="XmlTreeViewItemSelected"></TreeView>
        
        <!-- Right Panel -->
        <Label Name="FileNameLabel" Grid.Column="1" Grid.Row="1" VerticalContentAlignment="Center"
               HorizontalContentAlignment="Center" Background="Navy" 
               Foreground="White"></Label>
        <TreeView Name="MacroTreeView" Grid.Column="1" Grid.Row="2"
                  Visibility="Hidden">
            <TreeView.Resources>
                <DataTemplate x:Key="DynamicComponentTemplate">
                    <TreeViewItem Name="MacroTreeItem">
                        <DataGrid Name="MacroDg" AutoGenerateColumns="False">
                            <DataGrid.Columns>
                                <DataGridTemplateColumn Header="Attribute">
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <TextBlock Text="{Binding AttributeName}"/>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>
                                <DataGridTemplateColumn Header="Datatype">
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <TextBlock Text="{Binding Datatype}"/>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>
                                <DataGridTemplateColumn Header="{Binding Path=Header1}">
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <TextBox Text="{Binding ContentValue1}"/>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>
                                <DataGridTemplateColumn>
                                    <DataGridTemplateColumn.Header>
                                        <TextBlock Text="{Binding Path=Header2}"/>
                                    </DataGridTemplateColumn.Header>
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <TextBox Text="{Binding ContentValue2}"/>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>
                                <DataGridTemplateColumn>
                                    <DataGridTemplateColumn.Header>
                                        <TextBlock Text="{Binding Path=Header3}"/>
                                    </DataGridTemplateColumn.Header>
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <TextBox Text="{Binding ContentValue3}"/>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>
                                <DataGridTemplateColumn>
                                    <DataGridTemplateColumn.Header>
                                        <TextBlock Text="{Binding Path=Header4}"/>
                                    </DataGridTemplateColumn.Header>
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <TextBox Text="{Binding ContentValue4}"/>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>
                            </DataGrid.Columns>
                        </DataGrid>
                    </TreeViewItem>
                </DataTemplate>

                <utility:DataGridCellTemplateSelector x:Key="TemplateSelector" 
                                                    DynamicComponentTemplate="{StaticResource DynamicComponentTemplate}"/>
            </TreeView.Resources>
        </TreeView>
        <DataGrid x:Name="DgGrid" Grid.Column="1" Grid.Row="2"
                  AutoGenerateColumns="False" CanUserAddRows="False">
            <DataGrid.Resources>
                <DataTemplate x:Key="IntegerTemplate">
                    <TextBox Text="{Binding ContentValue1}"/>
                </DataTemplate>
                <DataTemplate x:Key="StringTemplate">
                    <TextBox Text="{Binding ContentValue1}"/>
                </DataTemplate>
                <DataTemplate x:Key="EnumTemplate">
                    <ComboBox ItemsSource="{Binding ContentValue1}">
                    </ComboBox>
                </DataTemplate>
                <DataTemplate x:Key="BooleanTemplate">
                    <CheckBox Content="{Binding ContentValue1}">
                        <CheckBox.Style>
                            <Style TargetType="CheckBox">
                                <Style.Triggers>
                                    <DataTrigger Binding="{Binding ContentValue1}" Value="True">
                                        <Setter Property="IsChecked" Value="True"/>
                                    </DataTrigger>
                                    <DataTrigger Binding="{Binding ContentValue1}" Value="False">
                                        <Setter Property="IsChecked" Value="False"/>
                                    </DataTrigger>
                                </Style.Triggers>
                            </Style>
                        </CheckBox.Style>
                    </CheckBox>
                </DataTemplate>


                <utility:DataGridCellTemplateSelector x:Key="TemplateSelector" 
                                                    EnumTemplate="{StaticResource EnumTemplate}"
                                                    StringTemplate="{StaticResource StringTemplate}"
                                                    BooleanTemplate="{StaticResource BooleanTemplate}"
                                                    IntegerTemplate="{StaticResource IntegerTemplate}"/>
            </DataGrid.Resources>

            <DataGrid.Columns>
                <DataGridTemplateColumn Header="Attribute">
                    <DataGridTemplateColumn.CellTemplate>
                        <DataTemplate>
                            <TextBlock Text="{Binding AttributeName}"/>
                        </DataTemplate>
                    </DataGridTemplateColumn.CellTemplate>
                </DataGridTemplateColumn>
                <DataGridTemplateColumn Header="Datatype">
                    <DataGridTemplateColumn.CellTemplate>
                        <DataTemplate>
                            <TextBlock Text="{Binding Datatype}"/>
                        </DataTemplate>
                    </DataGridTemplateColumn.CellTemplate>
                </DataGridTemplateColumn>
                <DataGridTemplateColumn Header="Value" CellTemplateSelector="{StaticResource TemplateSelector}">
                </DataGridTemplateColumn>
            </DataGrid.Columns>
        </DataGrid>
    </Grid>
</Page>
